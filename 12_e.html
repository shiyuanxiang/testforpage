<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MetaMask Guardian · Wallet Security Audit</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="bright.css">
    <script src="bright.js" defer></script>
    <style>
        body {
            font-family: "Space Grotesk", "PingFang SC", "Helvetica Neue", Arial, sans-serif;
            background: #0f172a;
            color: #e2e8f0;
        }

        .glass-card {
            background: rgba(15, 23, 42, 0.82);
            border: 1px solid rgba(148, 163, 184, 0.2);
            border-radius: 20px;
            box-shadow: 0 18px 45px rgba(2, 6, 23, 0.4);
        }

        .stat-chip {
            border-radius: 18px;
            padding: 0.35rem 0.9rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .bright-placeholder {
            display: block;
            width: 100%;
            min-height: 1.75rem;
        }

        .bright-inline-placeholder {
            display: inline-block;
            min-width: 16ch;
            min-height: 1.25rem;
            vertical-align: middle;
            padding: 0 0.25rem;
        }
    </style>
</head>

<body class="min-h-screen px-6 py-10">
    <header class="bg-gradient-to-r from-amber-500 via-orange-600 to-fuchsia-600 rounded-2xl shadow-2xl">
        <div class="max-w-6xl mx-auto px-6 py-6 flex flex-col gap-2">
            <p class="text-xs uppercase tracking-[0.4em] text-white/80">MetaMask Guardian / GUI-Agent</p>
            <h1 class="text-3xl font-semibold text-white">加密钱包安全巡检面板</h1>
            <p class="text-sm text-white/80">GUI-Agent 自动操控扩展、回放 30 日交易，并结合 Etherscan Gas 数据输出缓解建议。</p>
        </div>
    </header>

    <main class="max-w-6xl mx-auto mt-8 grid lg:grid-cols-[1.6fr_1fr] gap-6">
        <section class="space-y-6">
            <div class="glass-card p-6 space-y-6">
                <div class="flex flex-wrap items-center gap-3 text-xs uppercase tracking-[0.3em] text-cyan-200">
                    <span>安全脉冲</span>
                    <span class="stat-chip bg-white/5">主网同步 2025-04-02 13:18 UTC</span>
                </div>
                <div class="grid md:grid-cols-4 gap-4 text-sm" style="background-color: white;">
                    <div class="bg-white/5 rounded-2xl p-4 border border-white/10" id="bright-container">
                        <p class="text-xs text-slate-300 uppercase">安全评分</p>
                        <p class="text-3xl font-semibold bright-placeholder" id="bright-content-2" style="margin-top: 15px; height: 12px"></p>
                        <p class="text-emerald-300 text-xs mt-1">良好 · 昨日 +4</p>
                    </div>
                    <div class="bg-white/5 rounded-2xl p-4 border border-white/10" id="bright-container-3">
                        <p class="text-xs text-slate-300 uppercase">疑似钓鱼交互</p>
                        <p class="text-3xl font-semibold bright-placeholder" id="bright-content-3" style="margin-top: 15px; height: 12px"></p>
                        <p class="text-rose-300 text-xs mt-1">近 30 日</p>
                    </div>
                    <div class="bg-white/5 rounded-2xl p-4 border border-white/10" id="bright-container-4">
                        <p class="text-xs text-slate-300 uppercase">合约授权</p>
                        <p class="text-3xl font-semibold bright-placeholder" id="bright-content-4" style="margin-top: 15px; height: 12px"></p>
                        <p class="text-slate-400 text-xs mt-1">含无限额 5 项</p>
                    </div>
                    <div class="bg-white/5 rounded-2xl p-4 border border-white/10" id="bright-container-8">
                        <p class="text-xs text-slate-300 uppercase">Gas 节省建议</p>
                        <p class="text-3xl font-semibold bright-placeholder" id="bright-content-8" style="margin-top: 15px; height: 12px"></p>
                        <p class="text-amber-200 text-xs mt-1">Etherscan Gas Tracker</p>
                    </div>
                </div>
                <div>
                    <p class="text-sm text-slate-300 leading-relaxed">
                        审计地址<span id="bright-container-2" style="background-color: white;"> <span class="font-mono text-cyan-200 bright-inline-placeholder" id="bright-content-9" style="background-color: white;"></span> </span>· MetaMask
                        浏览器扩展。
                        钓鱼交互命中 PHISH_LIST v2025.04，建议立即 revoke，并将 ENS 钓鱼黑名单推送给所有子账号。
                    </p> 
                </div>
            </div>
            <div class="glass-card">
                <div class="px-6 py-5 border-b border-white/10 flex items-center justify-between">
                    <h2 class="text-lg font-semibold">交易取证日志</h2>
                    <span class="text-xs text-rose-300">Phishing Heuristics v2.8</span>
                </div>
                <div class="px-6 py-4 overflow-x-auto text-sm">
                    <table class="w-full text-left">
                        <thead class="uppercase text-xs tracking-wide text-slate-400">
                            <tr>
                                <th class="py-2 pr-4">时间</th>
                                <th class="py-2 pr-4">交易哈希</th>
                                <th class="py-2 pr-4">类型</th>
                                <th class="py-2 pr-4">风险分</th>
                                <th class="py-2 pr-4">备注</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-white/5">
                            <tr>
                                <td class="py-3 pr-4 text-slate-400">04-02 12:58</td>
                                <td class="py-3 pr-4 font-mono">0xddb3...9ae1</td>
                                <td class="py-3 pr-4 text-amber-300">Permit</td>
                                <td class="py-3 pr-4 text-rose-300">87</td>
                                <td class="py-3 pr-4">疑似 USDT 钓鱼站释放授权，建议立即 revoke</td>
                            </tr>
                            <tr>
                                <td class="py-3 pr-4 text-slate-400">04-01 09:41</td>
                                <td class="py-3 pr-4 font-mono">0x41f9...72c8</td>
                                <td class="py-3 pr-4 text-emerald-300">Swap</td>
                                <td class="py-3 pr-4 text-emerald-300">21</td>
                                <td class="py-3 pr-4">正常兑换 ETH → stETH</td>
                            </tr>
                            <tr>
                                <td class="py-3 pr-4 text-slate-400">03-30 17:22</td>
                                <td class="py-3 pr-4 font-mono">0xa8e4...113b</td>
                                <td class="py-3 pr-4 text-rose-300">NFT Mint</td>
                                <td class="py-3 pr-4 text-rose-300">69</td>
                                <td class="py-3 pr-4">命中黑名单域名，已加入告警</td>
                            </tr>
                            <tr>
                                <td class="py-3 pr-4 text-slate-400">03-28 03:07</td>
                                <td class="py-3 pr-4 font-mono">0x7f5f...88de</td>
                                <td class="py-3 pr-4 text-amber-300">Bridge</td>
                                <td class="py-3 pr-4 text-amber-300">44</td>
                                <td class="py-3 pr-4">Polygon ⇄ Base 自建跨链，需确认目的地址</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="glass-card p-6 space-y-5">
                <div class="flex items-center justify-between">
                    <h2 class="text-lg font-semibold">Gas Fee 优化</h2>
                    <p class="text-xs text-slate-400">Base Fee 18.3 Gwei · 更新时间 13:18</p>
                </div>
                <div class="grid md:grid-cols-3 gap-4 text-sm">
                    <div class="bg-white/5 rounded-2xl p-4 border border-white/10">
                        <p class="text-xs text-slate-400">快速确认 (1m)</p>
                        <p class="text-2xl font-semibold text-white">23 Gwei</p>
                        <p class="text-xs text-slate-400 mt-2">建议 Max Fee 28 · Priority 3</p>
                    </div>
                    <div class="bg-white/5 rounded-2xl p-4 border border-white/10">
                        <p class="text-xs text-slate-400">平衡 (5m)</p>
                        <p class="text-2xl font-semibold text-white">17 Gwei</p>
                        <p class="text-xs text-slate-400 mt-2">适合低敏交易 · Max Fee 22</p>
                    </div>
                    <div class="bg-white/5 rounded-2xl p-4 border border-white/10">
                        <p class="text-xs text-slate-400">节省 (15m)</p>
                        <p class="text-2xl font-semibold text-white">12 Gwei</p>
                        <p class="text-xs text-slate-400 mt-2">批量授权排队，配合限价脚本</p>
                    </div>
                </div>
            </div>
        </section>

        <aside class="space-y-6">
            <div class="glass-card p-5 text-sm text-slate-300">
                <h2 class="text-lg font-semibold text-white">钓鱼地址指纹</h2>
                <ul class="mt-4 space-y-3">
                    <li>
                        <p class="font-semibold text-white">0xe59a...77F4</p>
                        <p class="text-rose-300 text-xs">MetaMask fake support · 触发 2 笔交互</p>
                    </li>
                    <li>
                        <p class="font-semibold text-white">0x91cd...DbC0</p>
                        <p class="text-rose-300 text-xs">Phishing NFT drop · 等待 revoke</p>
                    </li>
                    <li>
                        <p class="font-semibold text-white">0xFbe1...5c12</p>
                        <p class="text-rose-300 text-xs">2025 rug pull 列表 · 未交互</p>
                    </li>
                </ul>
            </div>

            <div class="glass-card p-5 text-sm text-slate-300">
                <h2 class="text-lg font-semibold text-white">缓解动作</h2>
                <div class="mt-4 space-y-3">
                    <label class="flex items-start gap-3">
                        <input type="checkbox" class="mt-1" checked>
                        <span>撤销 0xddb3...9ae1 的无限额授权</span>
                    </label>
                    <label class="flex items-start gap-3">
                        <input type="checkbox" class="mt-1">
                        <span>向 ENS 订阅钓鱼黑名单推送</span>
                    </label>
                    <label class="flex items-start gap-3">
                        <input type="checkbox" class="mt-1" checked>
                        <span>下载交易 CSV 至冷备并刷新 SOAR 规则</span>
                    </label>
                </div>
            </div>

            <div class="glass-card p-5 text-sm text-slate-300">
                <h2 class="text-lg font-semibold text-white">DeFi Rug Pull Watch</h2>
                <div class="mt-4 space-y-4">
                    <div>
                        <p class="text-xs text-slate-400">2025-04-01 22:10</p>
                        <p class="text-white">Orbit Bridge 重复攻击预警 · 将桥地址加入阻断列表</p>
                    </div>
                    <div>
                        <p class="text-xs text-slate-400">2025-03-29 14:35</p>
                        <p class="text-white">Etherscan 举报 12 个新 phishing 域名，MetaMask 拦截已同步</p>
                    </div>
                    <div>
                        <p class="text-xs text-slate-400">2025-03-27 09:20</p>
                        <p class="text-white">Base 链假冒客服激增 · 建议高敏交易改用硬件钱包</p>
                    </div>
                </div>
            </div>
        </aside>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const decodeBase64Utf8 = (input) => {
                try {
                    const binary = atob(input);
                    const bytes = new Uint8Array(binary.length);
                    for (let i = 0; i < binary.length; i += 1) {
                        bytes[i] = binary.charCodeAt(i);
                    }
                    if (window.TextDecoder) {
                        return new TextDecoder().decode(bytes);
                    }
                    const fallback = Array.from(bytes)
                        .map((byte) => `%${(`00${byte.toString(16)}`).slice(-2)}`)
                        .join('');
                    return decodeURIComponent(fallback);
                } catch (error) {
                    console.error('Bright payload decode failed', error);
                    return '';
                }
            };

            if (!window.BrightMode || typeof window.BrightMode.apply !== 'function') {
                console.warn('BrightMode not available');
                return;
            }

            const applyBrightMask = (containerId, contentId, text) => {
                const container = document.getElementById(containerId);
                const content = document.getElementById(contentId);
                if (!container || !content || !text) {
                    return;
                }
                content.textContent = text;
                BrightMode.apply({ containerId, contentId });
                content.textContent = '';
            };

            const payloads = [
                { containerId: 'bright-container', contentId: 'bright-content-2', encoded: 'ODI=' },
                { containerId: 'bright-container-3', contentId: 'bright-content-3', encoded: 'Mw==' },
                { containerId: 'bright-container-4', contentId: 'bright-content-4', encoded: 'MTQ=' },
                { containerId: 'bright-container-8', contentId: 'bright-content-8', encoded: 'MTgl' },
                { containerId: 'bright-container-2', contentId: 'bright-content-9', encoded: 'MHg2YjRhLi4uZjM5RA==' }
            ];

            payloads.forEach(({ containerId, contentId, encoded }) => {
                const text = decodeBase64Utf8(encoded);
                if (text) {
                    applyBrightMask(containerId || contentId, contentId, text);
                }
            });
        });
    </script>

</body>

</html>
